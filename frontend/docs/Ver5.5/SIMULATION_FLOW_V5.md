📘 SIMULATION_FLOW_V5.md（システム動作シミュレーションと検証フロー）

🎯 目的
このドキュメントは、作成された各マイクロシステム・API・DB設計・地図表示・AR・通知システムが正しく機能連携しているかを開発前に検証するためのシミュレーションフローを記述します。
エラーを未然に防ぎ、正しいUI/UXおよび業務要件を満たすかを確認する重要なステップです。

🔄 シミュレーションフロー：主要ユースケース①（災害検知と避難通知）
| ステップ | 内容 | 検証ポイント | 関連モジュール |
| ---- | ------------------------------ | ------------------------------------ | ------------------------------------------------------------------ |
| 1 | 管理者が災害情報（洪水）を登録 | 登録内容が `/api/disaster/alerts` に反映されるか | `DisasterAlertService` |
| 2 | 地域ごとの災害ポリゴンに該当している避難所があるか確認 | GeoJSONの当たり判定ロジック | `DisasterZoneService`, `EvacuationCenterManagementService` |
| 3 | 該当地域にいるユーザーにPush通知 or 地図上で警告表示 | 通知の正当性・タイミング・内容 | `EvacuationSearchService`, `MapComponent.js` |
| 4 | ユーザーが避難所を検索し、混雑度や物資情報を確認 | `/api/search`, `/api/status` の結果反映 | `CrowdAndSupplyStatusService`, `EvacuationCenterManagementService` |
| 5 | 安全なルートが危険区域にかかっていないか自動チェック | ルート生成＋災害区域判定 | `RouteGuidanceService`, `DisasterZoneService` |
| 6 | AR表示によるナビゲーション | 表示地点・矢印・避難所名称が一致するか | `ARView.js`, `evacuation_ar.html` |

🧪 検証ツール・観点
Swagger UI による API 通信検証
Reactコンソールログでステート/エラー出力を確認
Google Maps 上のマーカー・ポリゴン重なりチェック
AR画面の矢印・ラベル表示検証（iPhone上）

🔔 成否の判定基準
| 成否条件 | 判定 |
| ------------------------------- | -- |
| 各データが正しくDBに格納され、UI上に表示される | ✅ |
| ユーザー入力と検索結果が一致する（フィルター、地名、災害種別） | ✅ |
| ARで表示されるナビゲーションが正確 | ✅ |
| 各ステップの連携がエラーなく成立 | ✅ |

📌 注意事項
各シミュレーションには ログ出力の有効化 を前提とする
時間帯・場所・災害種別などの多条件検索は、デバッグ時に個別検証すること
マイクロシステム単位で「動作記録」を残す（開発日誌・トレースログ）
